---
title: \large\bfseries{Template Modul}
author: "Irham Maulana Johani | Hermawan Sentyaki Sarjito | Jonathan"
date: "`r Sys.Date()`"
lang: bahasa
output:
  pdf_document:
    citation_package: natbib
    #template: bwHandout.tex
    includes:
       in_header: preamble.tex
    keep_tex: false
    toc: true
    toc_depth: 3
    number_sections: true
    latex_engine: pdflatex
#lot: true
lof: true    
fontsize: 11pt
geometry: margin=1in

bibliography: references.bib
#nocite: | 
#  @*

my_subtitle: "(Proposal)"
fancy: true
---

```{r setup, include=FALSE}
# Blok setup untuk konfigurasi global
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# Muat library yang dibutuhkan
library(tidyverse)
library(caret)
library(randomForest)
```

\begin{figure}[h]
\centering
\includegraphics[width=6.5cm]{gambar/vokasi6.png}
\end{figure}

\addtocounter{section}{0}
\setcounter{page}{1}

\newpage

# Proposal Proyek Data Mining

## 1. Judul Proyek

Analisis Prediktif Penyakit Jantung Menggunakan Algoritma Klasifikasi (Random Forest) Berbasis Data Klinis.

## Latar Belakang

Gagal jantung merupakan salah satu penyakit kardiovaskular kronis dengan angka kesakitan dan kematian yang tinggi secara global, sehingga menjadi beban besar bagi sistem kesehatan \citep{savarese2022global}. Studi epidemiologi terbaru menunjukkan bahwa jumlah kasus gagal jantung terus meningkat terus meningkat, terutama di kawasan Asia dengan jumlah data 33% di Asia Tengah hingga 186% dalam rentang tahun 1990 hingga 2019 dan negara berpenghasilan menengah  \citep{feng2024epidemiology}. Kondisi ini tidak hanya berdampak pada peningkatan angka hospitalisasi dan readmission, tetapi juga mengurangi kualitas hidup pasien dan menambah beban ekonomi masyarakat serta fasilitas pelayanan kesehatan \citep{yan2023burden}. Dalam konteks tersebut, identifikasi dini pasien yang berisiko tinggi menjadi sangat penting untuk menekan angka rawat inap berulang dan mortalitas.

Dalam praktik klinis, penilaian risiko pasien gagal jantung masih banyak bergantung pada kombinasi penilaian subjektif klinisi, pedoman klinis, dan pengamatan terhadap berbagai parameter klinis secara manual. Berbagai penelitian juga memperkuat bahwa pasien gagal jantung memiliki angka readmission dan mortalitas jangka pendek yang tinggi yang merefleksikan belum optimal dalam stratifikasi risiko di layanan kesehatan \citep{sabouri2023machine}. Hal ini menimbulkan risiko bahwa sebagian pasien dengan profik risiko tinggi tidak teridentifikasi tepat waktu sehingga tidak mendapatkan prioritas pemantauan dan intervensi yang lebih intensif.

Seiring meluasnya penggunaan electronic health records (EHR), data klinis seperti karakteristik pasien, hasil laboratorium, diagnosis, prosedur, dan terapi kini tersimpan dalam jumlah besar dan relatif terstruktur di fasilitas pelayanan kesehatan. Integrasi data EHR dengan metode analitik, seperti kecerdasan buatan dan machine learning telah dilaporkan mampu mentransformasi cara prediksi dan manajemen risiko penyakit kardiovaskular \citep{tsai2025harnessing}. Berdasarkan penelitian lain menunjukkan, bahwa teknik data mining dapat dimanfaatkan untuk mengekstraksi parameter klinis penting serta data laboratorium guna memperbaiki subclassificiation gagal jantung \citep{vuori2023use}. 

Sejalan dengan perkembangan tersebut, berbagai algoritma klasifikasi seperti logistic regression, random forest, support vector machine, dan gradient boosting telah diterapkan untuk diagnosis, prediksi, dan prognosis gagal jantung, dengan performa yang umumnya lebih baik daripada skor risiko tradisional \citep{saqib2024machine}. Studi lain yang memanfaatkan Heart Failure Prediciton Dataset juga menunjukkan bahwa perbandingan beberapa model klasifikasi memungkinkan identifikasi algoritma yang optimal untuk klasifikasi gagal jantung \citep{chulde2025classification}. Di Indonesia, terdapat penelitian yang telah mengevaluasi berbagai model machine learning untuk memprediksi keparahan dan readmission pasien gagal jantung serta menemukan model dengan performa terbaik untuk diintegrasikan ke dalam aplikasi pemantauan mandiri pasien \citep{indriany2024predicting}. Meskipun demikian, diperlukan penerapan dan analisis model klasifikasi berbasis Random Forest untuk mengidentifikasi pasien berisiko tinggi gagal jantung sehingga dapat dibangun model prediksi dengan performa yang dapat menghasilkan pengetahui mengenai faktor-faktor klinis yang berkontribusi terhadap kategori risiko tinggi tersebut.

## Rumusan Masalah

1. Bagaimana karakteristik data klinis pasien gagal jantung yang ditanjau dari distirbusi kelas risiko serta variabel klinisnya?
2. Bagaimana kinerja model klasifikasi Random Forest dalam mengidentifikasi pasien berisiko tinggi gagal jantung berdasarkan metrik evaluasi seperti akurasi, presisi, recall, dan F1-score?
3. Fitur-fitur klinis apa saja yang paling berkontribusi terhadap penentuan kategori pasien berisiko tinggi gagal jantung berdasarkan hasil analisis model Random Forest?


## Tujuan Penelitian

1. Mendeskripsikan karakteristik data klinis pasien gagal jantung termasuk distirbusi kelas risiko dan variabel-variabel klinis yang relevan.
2. Membangun dan mengevaluasi model klasifikasi Random Forest untuk mengidentifikasi pasien berisiko tinggi gagal jantung menggunakan metrik evaluasi seperti akurasi, presisi, recall, dan F1-score.
3. Mengidentifikasi fitur-fitur klinis yang paling berpengaruh terhadap penentuan kategori pasien berisiko tinggi gagal jantung berdasarkan hasil analisis model Random Forest.

## Sumber dan Karakteristik Data

* **Sumber Data:** Dataset publik "Heart Failure Prediction Dataset" yang diperoleh dari platform Kaggle.
* **Karakteristik Data:** Dataset awal terdiri dari 918 observasi (baris) dan 12 variabel (kolom).
* **Target Variabel:** `HeartDisease` (Biner: 1 = Sakit Jantung, 0 = Normal).
* **Variabel Prediktor:** Mencakup data demografis (`Age`, `Sex`), data klinis (`RestingBP`, `Cholesterol`), dan hasil tes (`MaxHR`, `RestingECG`, dll.).
* **Kualitas Data:** Terdapat potensi masalah kualitas data, seperti nilai '0' yang tidak logis pada kolom `Cholesterol` dan `RestingBP`, yang harus ditangani pada tahap *Data Preparation*.

## Metodologi Data Mining (CRISP-DM)

Metodologi proyek mengikuti alur standar CRISP-DM.

### Tahap 1 & 2: Business & Data Understanding

Tahap ini mencakup pemahaman tujuan (telah dijelaskan di Latar Belakang) dan pemahaman data awal. Kita memuat data dan memeriksanya.

```{r data-understanding}
# Muat data
df <- read.csv("dataset/heart.csv")

# Tampilkan struktur data (mirip df.info())
glimpse(df)

# Tampilkan ringkasan statistik (mirip df.describe())
summary(df)
```

**Representasi (Temuan Awal):**
Dari `summary(df)`, kita melihat masalah kualitas data:
1.  `RestingBP` memiliki nilai minimum `0`.
2.  `Cholesterol` memiliki nilai minimum `0`.
Kedua nilai ini tidak mungkin secara biologis dan akan kita tangani sebagai data hilang.

### Tahap 3: Data Preparation

Ini adalah tahap kritis di mana kita membersihkan data, melakukan imputasi, dan membaginya.

```{r data-preparation-split}
# 1. Membersihkan 'RestingBP' (Drop baris karena jumlahnya sedikit)
df_clean <- df %>%
  filter(RestingBP > 0)
print(paste("Jumlah baris setelah membersihkan RestingBP:", nrow(df_clean)))

# 2. Split Data (WAJIB dilakukan SEBELUM imputasi untuk mencegah data leakage)
set.seed(26)
trainIndex <- createDataPartition(df_clean$HeartDisease, p = .8, 
                                  list = FALSE, 
                                  times = 1)
train_data <- df_clean[ trainIndex,]
test_data  <- df_clean[-trainIndex,]
```

```{r data-preparation-impute-factor}
# 3. Imputasi 'Cholesterol = 0'
# Hitung median HANYA dari data latih
valid_chol_median <- train_data %>%
  filter(Cholesterol > 0) %>%
  summarise(MedianChol = median(Cholesterol, na.rm = TRUE)) %>%
  pull(MedianChol)

print(paste("Median kolesterol (dari data latih):", valid_chol_median))

# Terapkan median ke data latih dan data uji
train_data <- train_data %>%
  mutate(Cholesterol = ifelse(Cholesterol == 0, valid_chol_median, Cholesterol))

test_data <- test_data %>%
  mutate(Cholesterol = ifelse(Cholesterol == 0, valid_chol_median, Cholesterol))

# 4. Konversi Variabel Kategorikal menjadi Factor
categorical_cols <- c('Sex', 'ChestPainType', 'RestingECG', 'ExerciseAngina', 'ST_Slope', 'FastingBS', 'HeartDisease')

train_data <- train_data %>%
  mutate(across(all_of(categorical_cols), as.factor))

test_data <- test_data %>%
  mutate(across(all_of(categorical_cols), as.factor))

# Tampilkan struktur data latih setelah bersih
glimpse(train_data)
```

### Tahap 4: Modeling

Kita melatih model menggunakan data latih (`train_data`) dengan metode 10-Fold Cross-Validation (CV) untuk memastikan model stabil dan *robust*.

```{r modeling}
# Tentukan metode kontrol: 10-Fold CV
set.seed(18)
trControl <- trainControl(method = "cv",
                          number = 10) 

# Latih model Random Forest
# Kita juga menambahkan 'preProcess' untuk scaling (fungsi minor)
model_rf <- train(HeartDisease ~ ., 
                  data = train_data, 
                  method = "rf",
                  trControl = trControl,
                  preProcess = c("center", "scale")
                 )

# Representasi (Hasil Cross-Validation):
# Menampilkan akurasi rata-rata dari 10-fold CV
print(model_rf)
```

### Tahap 5: Evaluation

Model yang sudah dilatih (`model_rf`) kini dievaluasi kinerjanya menggunakan data uji (`test_data`) yang belum pernah dilihat sebelumnya.

```{r evaluation}
# Buat prediksi pada data uji
y_pred <- predict(model_rf, newdata = test_data)
y_test <- test_data$HeartDisease

# Representasi (Confusion Matrix dan Statistik Lengkap):
cm <- confusionMatrix(y_pred, y_test)
print(cm)
```

## Teknik dan Algoritma yang Digunakan

* **Algoritma Utama:** **Random Forest**
* **Fungsi Mayor:** **Klasifikasi**. Tujuan model adalah mengklasifikasikan pasien ke dalam dua kelas: '0' (Sehat) atau '1' (Sakit Jantung).
* **Fungsi Minor:**
    * **Pembersihan Data:** Menghapus baris dengan `RestingBP = 0`.
    * **Imputasi:** Mengganti nilai `Cholesterol = 0` dengan **Median** dari data latih (bukan *mean*, untuk menghindari bias dari *outlier*).
    * **Transformasi Tipe Data:** Mengubah variabel objek (char) menjadi *factor* agar dapat diproses oleh R.
    * **Normalisasi (Scaling):** Menggunakan `center` dan `scale` (standarisasi Z-score) pada fitur numerik selama proses *training* untuk membantu beberapa algoritma (meskipun dampaknya minimal pada Random Forest, ini adalah *best practice*).

## Rencana Implementasi dan Alat yang Digunakan

* **Alat Utama:** RStudio
* **Bahasa:** R
* **Paket (Library) Kunci:**
    * `tidyverse` (untuk manipulasi data/Data Preparation).
    * `caret` (untuk proses *split data*, *modeling*, *preprocessing*, dan *evaluation*).
    * `randomForest` (sebagai *engine* algoritma utama).
    * `ggplot2` (untuk visualisasi).

## Hasil yang Diharapkan dan Dampak

### Hasil Proyek (Representasi Output)

1.  **Model Prediktif:** Sebuah model R (`model_rf`) yang siap digunakan, yang terbukti memiliki akurasi **`r round(cm$overall['Accuracy'], 3)`** dan Kappa **`r round(cm$overall['Kappa'], 3)`** pada data uji.
2.  **Visualisasi Hasil (Confusion Matrix):**

    ```{r plot-cm}
    # Plot heatmap confusion matrix
    cm_table <- as.data.frame(cm$table)
    ggplot(cm_table, aes(x = Reference, y = Prediction, fill = Freq)) +
      geom_tile(color = "white") +
      geom_text(aes(label = Freq), vjust = 1) +
      scale_fill_gradient(low = "white", high = "blue") +
      labs(title = "Confusion Matrix (Test Data)") +
      theme_minimal()
    ```

3.  **Insight Kunci (Variable Importance):** Kita dapat mengekstrak fitur apa yang dianggap paling penting oleh model.

    ```{r plot-importance}
    # Plot variable importance
    var_imp <- varImp(model_rf)
    plot(var_imp, main = "Variable Importance (Faktor Paling Berpengaruh)")
    ```

### Dampak dan Potensi Penerapan

Berdasarkan hasil di atas (terutama *Variable Importance*), kita dapat memberikan *insight* bagi praktisi medis. Model ini dapat digunakan sebagai **Sistem Pendukung Keputusan (Decision Support System)** untuk *screening* awal pasien. Pasien yang diprediksi memiliki risiko tinggi dapat segera dirujuk untuk pemeriksaan lebih lanjut, sehingga mempercepat proses diagnosis dan penanganan.

\nocite{*}
   